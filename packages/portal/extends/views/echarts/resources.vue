<template>
    <el-content>
        <div class="index">
            <div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>
                    </el-block-bg>
                </div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
            </div>
            <div></div>
            <div>
                <div class="unitRank rank">
                    <div class="rankDiv">
                        <el-block-bg title="模板库">
                            <div class="con">
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                            </div>
                        </el-block-bg>
                    </div>
                    <div class="rankDiv">
                        <el-block-bg title="模板库">
                            <div class="con">
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                            </div>
                        </el-block-bg>
                    </div>
                </div>
                <div class="unitRank rankEcharts">
                    <el-block-bg>
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>
                    </el-block-bg>
                </div>
                <div class="unitRank rank">
                    <div class="rankDiv">
                        <el-block-bg title="模板库">
                            <div class="con">
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                            </div>
                        </el-block-bg>
                    </div>
                    <div class="rankDiv">
                        <el-block-bg title="模板库">
                            <div class="con">
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                                <div>
                                    <p>数据总量：200</p>
                                    <p>本年新增：50</p>
                                    <p>本月新增：20</p>
                                </div>
                            </div>
                        </el-block-bg>
                    </div>
                </div>
            </div>
            <div></div>
            <div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
                <div class="unitRank">
                    <el-block-bg title="模板库">
                        <div class="con">
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                            <div>
                                <p>数据总量：200</p>
                                <p>本年新增：50</p>
                                <p>本月新增：20</p>
                            </div>
                        </div>

                    </el-block-bg>
                </div>
            </div>
        </div>
    </el-content>
</template>
<script lang="ts">
import { Col, Spin, Select, Table } from "@h3/antd-vue";
import { Component, Prop, Vue, Watch} from 'vue-property-decorator';
import tableList from '@/../extends/views/echarts/components/table.vue';
import blockBg from '@/../extends/components/maps/blockBg.vue';
import content from "@/../extends/components/maps/content.vue";
import axios from 'axios';
import api  from '@/../extends/api';
import * as echarts from 'echarts';
// import Divider from "../../../../../admin/src/views/print-template/center-panel/divider.vue";
const qs = require('qs');

@Component({
    name: 'echartsIndex',
    components: {
        ACol: Col,
        ASpin:Spin,
        ASelect: Select,
        ASelectOption: Select.Option,
        ATable: Table,
        tableList,
        elBlockBg: blockBg,
        elContent: content
    },
})

export default class echartsIndex extends Vue {
    spinning:false;

    unitList:any = [
        {
            value: 'jack',
            label: 'Jack',
        },
        {
            value: 'clo',
            label: 'clo',
        },
    ]

    tableData:any = {
        columns: [
            {
                title: '序号',
                customRender: (text,record,index) => `${index+1}`,
                width:'60px'
            },
            {
                title: '被审计单位',
                dataIndex: 'courseName',
                key: 'courseName',
                ellipsis: true,
                customRender: (value, row, index) => {
                    let obj = "";
                    if(value){
                    obj = value;
                    }else{
                        obj = "-"
                    }
                    return obj;
                }
            },
            {
                title: '需整改问题数',
                dataIndex: 'updateTime',
                key: 'updateTime',
                ellipsis: true,
                customRender: (value, row, index) => {
                    let obj = "";
                    if(value){
                    obj = value;
                    }else{
                        obj = "-"
                    }
                    return obj;
                }
            },
            {
                title: '整改中问题数',
                dataIndex: 'enabled',
                key: 'enabled',
                ellipsis: true,
                customRender: (value, row, index) => {
                    let obj = "";
                    if(value){
                    obj = '发布';
                    }else{
                        obj = "未发布"
                    }
                    return obj;
                },
            },
            {
                title: '整改完成问题数',
                dataIndex: 'questionsCount',
                key: 'questionsCount',
                ellipsis: true,
                customRender: (value, row, index) => {
                    let obj = "";
                    if(value){
                    obj = value;
                    }else{
                        obj = "-"
                    }
                    return obj;
                },
            },
            {
                title: '问题整改进度',
                dataIndex: "operation",
                scopedSlots: { customRender: "operation" },
            },
        ],
        data:[],
    }

    echartsData:any={
        type:['pie','pie','pie'],
        radius:["array","","array"],
        title:["整改项目完成情况","整改项目逾期情况","整改问题完成情况"],
        data:[
            [
                { value: 1048, name: '整改中' },
                { value: 735, name: '已完成' },
            ],
            [
                { value: 100, name: '逾期' },
                { value: 1000, name: '正常' },
            ],
            [
                { value: 1048, name: '整改中' },
                { value: 735, name: '已完成' },
            ],
        ],
        color:[
            ['rgba(53,89,155)', 'rgba(67,114,85)'],
            ['rgba(123,61,70)', 'rgba(53,89,155)'],
            ['rgba(53,89,155)', 'rgba(67,114,85)'],
        ]
    }

    async mounted(){
        this.init();
    }

    //第一个表格
    async queryTopList(){
        // const res:any = await api.queryTopList();
        // if(res.code === '00000'){

        // }
    }

    init() {
        let chartDom = document.getElementsByClassName('echartsDiv');
        for (var i = 0; i < chartDom.length; i++) {
            let myChart:any = echarts.init(chartDom[i]as HTMLElement,null, {
                width: 300,
                height: 250,
            });
            let option:any = {
                legend: {
                    orient: 'vertical',
                    x:'right',      //可设定图例在左、右、居中
                    y:'bottom',
                    itemWidth: 12,     // 图例标记的图形宽度
                    itemHeight: 12,
                    align: 'left',
                    padding:[0,15,20,0],
                    //图例中文字的样式
                    textStyle:{
                        fontStyle:"nomal",
                        color:"rgba(145,176,210)", //文字的颜色
                        // fontSize: 20, //文字的字号
                        // lineHeight: 12, //行高
                    },
                },
                color: this.echartsData.color[i],
            };
            if(this.echartsData.type[i] === 'bar'){
                option["tooltip"] = {
                    trigger: 'axis',
                    axisPointer: {
                    // Use axis to trigger tooltip
                    type: 'shadow' // 'shadow' as default; can also be 'line' or 'shadow'
                    }
                }
                option["grid"] = {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                }
                option["yAxis"] = {
                    name: "名称1",
                    type: 'value'
                }
                option["xAxis"] = {
                    name:"名称2",
                    type: 'category',
                    data: ['CPA', 'CIA', 'CISA', 'CICPA', 'ACCA', '其他']
                }
                option["series"] = [
                    {
                        name: '内部人才',
                        type: 'bar',
                        stack: 'total',
                        label: {
                            show: true
                        },
                        emphasis: {
                            focus: 'series'
                        },
                        data: [5, 15, 22, 20, 30, 22]
                    },
                    {
                        name: '外部人才',
                        type: 'bar',
                        stack: 'total',
                        label: {
                            show: true
                        },
                        emphasis: {
                            focus: 'series'
                        },
                        data: [0, 6, 10, 5, 11, 15]
                    }
                ]
            }else if(this.echartsData.type[i] === 'pie'){
                let dataNum = 0;
                this.echartsData.data[i].forEach(e => {
                    dataNum += e.value;
                });
                option["tooltip"] = {
                    trigger: 'item'
                }
                if(this.echartsData.radius[i] === "array"){
                    option["title"] = {
                        text: dataNum, //主标题文本
                        subtext: "总数", //副标题文本
                        left: "43%",
                        top: "48%",
                        textStyle: {
                            fontSize: 22,
                            color: "rgba(146,177,211)",
                            // align: "center",
                        },
                        subtextStyle: {
                            fontFamily: "微软雅黑",
                            fontSize: 12,
                            color: "rgba(146,177,211)",
                        },
                        x: 'center',
                        textAlign:'center'
                    }
                }
                option["series"] = [
                    {
                        type: this.echartsData.type[i],
                        center: ['45%', '60%'],
                        radius: this.echartsData.radius[i] === "array" ? ['40%','70%'] : "70%",
                        avoidLabelOverlap: false,
                        label: {
                            show: false,
                            position: 'center',
                            normal: {
                                show: false,
                                textStyle: {
                                    color: "#red"
                                },
                            },
                        },
                        emphasis: {
                            label: {
                                show: false,
                            }
                        },
                        labelLine: {
                            show: false,
                            length: 10,
                        },
                        data: this.echartsData.data[i]
                    }
                ]
            }else if(this.echartsData.type[i] === 'line'){
                option.legend.y = "top"
                option["tooltip"] = {
                    trigger: 'axis'
                }
                option["grid"] = {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                }
                option["yAxis"] = {
                    type: 'value'
                }
                option["xAxis"] = {
                    type: 'category',
                    data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月','9月','10月','11月','12月']
                }
                option["series"] = [
                    {
                    name: '今年',
                    type: 'line',
                    stack: 'Total',
                    data: [120, 132, 101, 134, 90, 230, 210]
                    },
                    {
                    name: '去年',
                    type: 'line',
                    stack: 'Total',
                    data: [220, 182, 191, 234, 290, 330, 310]
                    },
                ]
            }
            option && myChart.setOption(option);
        }
    }

}
</script>
<style lang="less" scoped>
    .index{
        display: grid;
        grid-template-columns: 25% 1% 47% 1% 25%;
        width: 100%;
        height: auto;
        .chooseDiv{
            display: flex;
            margin-top:40px;
            color: rgba(217,218,222);
            margin:51px 5px 10px 0.775rem;
        }
        .numCount{
            font-size:14px;
            line-height: 32px;
        }
        .ant-select{
            width: 200px;
            margin-left: 10px;
        }
        .ant-table-wrapper{
            margin: 0 5px 20px 0.775rem;
        }
        /deep/.ant-table-thead > tr > th{
            padding: 8px;
            background: rgba(7,22,58);
            color: #fff;
        }
        .echartsDiv{
            margin-top: 35px;
        }
        .con{
            display: flex;
            justify-content: space-around;
            color:#fff;
            margin-top: 50px;
            p{
                margin-bottom: 10px;
            }
        }
    }
    .unitRank {
        width: 100%;
        height: 200px;
        margin-bottom: 7px;
        position: relative;
    }
    .rank{
        display: flex;
        justify-content: space-between;
    }
    .rankDiv{
        width: 49%;
    }
    .rankEcharts{
        height:407px;
        .con{
            margin-top: 0;
        }
    }
    .rankEcharts > .jobOverviewJiao{
        border: 0!important;
    }
    .rankEcharts > .jobOverviewJiao:after,.rankEcharts > .jobOverviewJiao:before{
        width: 1.5rem;
        height: 1.5rem;
    }
    /deep/ .rankEcharts > .jobOverviewJiao > strong,/deep/ .rankEcharts > .jobOverviewJiao > i{
        width: 1.5rem!important;
        height: 1.5rem!important;
    }
</style>
